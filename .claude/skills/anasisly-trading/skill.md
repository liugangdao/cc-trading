---
name: anasisly-trading
description: 精简的交易日志分析技能 - 快速识别交易问题，提供核心改进建议
---

# 交易日志分析技能

快速分析交易数据，聚焦问题识别和改进措施，生成约300字的精简报告。

## 目的

- 识别关键交易问题（风险管理、执行纪律、心理模式）
- 提供 3-5 条可执行的改进建议
- 生成简洁的诊断报告（约300字）

## 分析流程

### 1. 数据读取
- 从 `./trading-data/trades-YYYY-MM.jsonl` 读取 JSONL 文件（或用户指定的文件路径）
- 通过 PositionID 获取最新持仓状态
- 统计平仓交易数量

### 2. 核心指标计算
- 总盈亏 & 胜率
- 止盈/止损触发率
- 平均持仓时间
- 仓位大小一致性

### 3. 问题检测（关键）
**风险管理问题：**
- 仓位大小不一致（标准差 > 50%）
- 单笔风险过高（> 5% 账户余额）
- 风险收益比不合理（< 1:1.5）

**执行纪律问题：**
- 过早获利了结（手动平仓率 > 60%）
- 持仓时间与计划不符
- 忽视止损/止盈

**心理模式问题：**
- 恐惧模式：过早平仓、超短持仓
- 过度自信：连胜后仓位暴涨
- FOMO：快速连续入场
- 复仇交易：亏损后加仓

### 4. 生成改进建议
优先级排序（3-5 条）：
1. 最严重的风险管理问题
2. 最影响盈利的执行问题
3. 最明显的心理模式问题

## 输出格式

生成约 300 字的精简诊断报告：

```markdown
# 交易诊断 - [月份 年份]

## 核心数据
- 总盈亏：$X (X%)｜胜率：X%｜交易数：X 笔
- 止盈率：X%｜止损率：X%｜手动平仓：X%
- 平均持仓：X 分钟/小时

## 检测问题 (🔴 高危 / 🟡 警告)

🔴 **[问题类别]**
- [具体问题描述 + 数据支持]
- 影响：[对交易的负面影响]

🟡 **[问题类别]**
- [具体问题描述]

## 改进建议 (按优先级)

1. **[最关键]** [具体可执行的措施]
2. **[重要]** [具体可执行的措施]
3. **[建议]** [具体可执行的措施]

## 下月目标
- [3-5 个可衡量的具体目标]
```

**字数控制：**
- 核心数据：50 字以内
- 检测问题：100-150 字
- 改进建议：100-120 字
- 下月目标：50 字以内

## 使用方法

**基本调用：**
```
/anasisly-trading
```
- 自动分析当前月份：`./trading-data/trades-YYYY-MM.jsonl`

**指定文件：**
```
/anasisly-trading ./trading-data/trades-2025-12.jsonl
```
- 分析指定的 JSONL 文件

**工作流程：**
1. 如果用户未指定文件，询问要分析的月份或文件路径
2. 读取并解析 JSONL 数据
3. 计算核心指标并检测问题
4. 生成约 300 字的精简诊断报告
5. 保存到 `./trading-data/reports/diagnosis-YYYY-MM.md`

## 技术要点

- 处理 JSONL 中的更新记录（取 positionId 的最新版本）
- 仓位大小一致性用标准差衡量
- 持仓时间计算：closeTime - openTime
- 优雅处理损坏的 JSON 行（跳过并继续）

## 核心原则

**好的诊断报告：**
- 直击要害，不罗列数据
- 问题优先级明确（高危 > 警告）
- 建议具体可执行，不空泛
- 聚焦前 3-5 个最关键问题
- 控制在 300 字左右

**避免：**
- 堆砌大量统计数据
- 通用化建议（如 "需要改进风险管理"）
- 没有数据支持的结论
- 超过 5 个改进建议（会导致执行困难）
